{"version":3,"file":"pages.esm.js","sources":["../../src/alpha/pages.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  compatWrapper,\n  convertLegacyRouteRef,\n} from '@backstage/core-compat-api';\nimport {\n  createPageExtension,\n  coreExtensionData,\n  createExtensionInput,\n} from '@backstage/frontend-plugin-api';\nimport {\n  AsyncEntityProvider,\n  entityRouteRef,\n} from '@backstage/plugin-catalog-react';\nimport { catalogExtensionData } from '@backstage/plugin-catalog-react/alpha';\nimport { rootRouteRef } from '../routes';\nimport { useEntityFromUrl } from '../components/CatalogEntityPage/useEntityFromUrl';\nimport { buildFilterFn } from './filter/FilterWrapper';\n\nexport const catalogPage = createPageExtension({\n  defaultPath: '/catalog',\n  routeRef: convertLegacyRouteRef(rootRouteRef),\n  inputs: {\n    filters: createExtensionInput({\n      element: coreExtensionData.reactElement,\n    }),\n  },\n  loader: async ({ inputs }) => {\n    const { BaseCatalogPage } = await import('../components/CatalogPage');\n    const filters = inputs.filters.map(filter => filter.output.element);\n    return compatWrapper(<BaseCatalogPage filters={<>{filters}</>} />);\n  },\n});\n\nexport const catalogEntityPage = createPageExtension({\n  name: 'entity',\n  defaultPath: '/catalog/:namespace/:kind/:name',\n  routeRef: convertLegacyRouteRef(entityRouteRef),\n  inputs: {\n    contents: createExtensionInput({\n      element: coreExtensionData.reactElement,\n      path: coreExtensionData.routePath,\n      routeRef: coreExtensionData.routeRef.optional(),\n      title: catalogExtensionData.entityContentTitle,\n      filterFunction: catalogExtensionData.entityFilterFunction.optional(),\n      filterExpression: catalogExtensionData.entityFilterExpression.optional(),\n    }),\n  },\n  loader: async ({ inputs }) => {\n    const { EntityLayout } = await import('../components/EntityLayout');\n    const Component = () => {\n      return (\n        <AsyncEntityProvider {...useEntityFromUrl()}>\n          <EntityLayout>\n            {inputs.contents.map(({ output }) => (\n              <EntityLayout.Route\n                key={output.path}\n                path={output.path}\n                title={output.title}\n                if={buildFilterFn(\n                  output.filterFunction,\n                  output.filterExpression,\n                )}\n              >\n                {output.element}\n              </EntityLayout.Route>\n            ))}\n          </EntityLayout>\n        </AsyncEntityProvider>\n      );\n    };\n    return compatWrapper(<Component />);\n  },\n});\n\nexport default [catalogPage, catalogEntityPage];\n"],"names":[],"mappings":";;;;;;;;;AAmCO,MAAM,cAAc,mBAAoB,CAAA;AAAA,EAC7C,WAAa,EAAA,UAAA;AAAA,EACb,QAAA,EAAU,sBAAsB,YAAY,CAAA;AAAA,EAC5C,MAAQ,EAAA;AAAA,IACN,SAAS,oBAAqB,CAAA;AAAA,MAC5B,SAAS,iBAAkB,CAAA,YAAA;AAAA,KAC5B,CAAA;AAAA,GACH;AAAA,EACA,MAAQ,EAAA,OAAO,EAAE,MAAA,EAAa,KAAA;AAC5B,IAAA,MAAM,EAAE,eAAA,EAAoB,GAAA,MAAM,OAAO,wCAA2B,CAAA,CAAA;AACpE,IAAA,MAAM,UAAU,MAAO,CAAA,OAAA,CAAQ,IAAI,CAAU,MAAA,KAAA,MAAA,CAAO,OAAO,OAAO,CAAA,CAAA;AAClE,IAAA,OAAO,8BAAe,KAAA,CAAA,aAAA,CAAA,eAAA,EAAA,EAAgB,yBAAY,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA,EAAA,OAAQ,GAAK,CAAE,CAAA,CAAA;AAAA,GACnE;AACF,CAAC,EAAA;AAEM,MAAM,oBAAoB,mBAAoB,CAAA;AAAA,EACnD,IAAM,EAAA,QAAA;AAAA,EACN,WAAa,EAAA,iCAAA;AAAA,EACb,QAAA,EAAU,sBAAsB,cAAc,CAAA;AAAA,EAC9C,MAAQ,EAAA;AAAA,IACN,UAAU,oBAAqB,CAAA;AAAA,MAC7B,SAAS,iBAAkB,CAAA,YAAA;AAAA,MAC3B,MAAM,iBAAkB,CAAA,SAAA;AAAA,MACxB,QAAA,EAAU,iBAAkB,CAAA,QAAA,CAAS,QAAS,EAAA;AAAA,MAC9C,OAAO,oBAAqB,CAAA,kBAAA;AAAA,MAC5B,cAAA,EAAgB,oBAAqB,CAAA,oBAAA,CAAqB,QAAS,EAAA;AAAA,MACnE,gBAAA,EAAkB,oBAAqB,CAAA,sBAAA,CAAuB,QAAS,EAAA;AAAA,KACxE,CAAA;AAAA,GACH;AAAA,EACA,MAAQ,EAAA,OAAO,EAAE,MAAA,EAAa,KAAA;AAC5B,IAAA,MAAM,EAAE,YAAA,EAAiB,GAAA,MAAM,OAAO,yCAA4B,CAAA,CAAA;AAClE,IAAA,MAAM,YAAY,MAAM;AACtB,MAAA,uBACG,KAAA,CAAA,aAAA,CAAA,mBAAA,EAAA,EAAqB,GAAG,gBAAA,EACvB,EAAA,kBAAA,KAAA,CAAA,aAAA,CAAC,YACE,EAAA,IAAA,EAAA,MAAA,CAAO,QAAS,CAAA,GAAA,CAAI,CAAC,EAAE,QACtB,qBAAA,KAAA,CAAA,aAAA;AAAA,QAAC,YAAa,CAAA,KAAA;AAAA,QAAb;AAAA,UACC,KAAK,MAAO,CAAA,IAAA;AAAA,UACZ,MAAM,MAAO,CAAA,IAAA;AAAA,UACb,OAAO,MAAO,CAAA,KAAA;AAAA,UACd,EAAI,EAAA,aAAA;AAAA,YACF,MAAO,CAAA,cAAA;AAAA,YACP,MAAO,CAAA,gBAAA;AAAA,WACT;AAAA,SAAA;AAAA,QAEC,MAAO,CAAA,OAAA;AAAA,OAEX,CACH,CACF,CAAA,CAAA;AAAA,KAEJ,CAAA;AACA,IAAO,OAAA,aAAA,iBAAe,KAAA,CAAA,aAAA,CAAA,SAAA,EAAA,IAAU,CAAE,CAAA,CAAA;AAAA,GACpC;AACF,CAAC,EAAA;AAED,YAAe,CAAC,aAAa,iBAAiB,CAAA;;;;"}